(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[408],{4780:function(t,e,r){"use strict";r.r(e),r.d(e,{Button:function(){return s}});var o=r(7437);r(2265);var n=r(1396),a=r.n(n),l=r(7636),i=r.n(l);let s=t=>{let{el:e="link",label:r,newTab:n,href:l,appearance:s,className:c,onClick:u,type:d="button",disabled:p,invert:v,children:y}=t,h=e,f=n?{target:"_blank",rel:"noopener noreferrer"}:{},m=[i().button,c,i()["appearance--".concat(s)],v&&i()["".concat(s,"--invert")]].filter(Boolean).join(" "),g=(0,o.jsxs)("div",{className:i().content,children:[(0,o.jsx)("span",{className:i().label,children:r}),y]});if((u||"submit"===d)&&(h="button"),"link"===h)return(0,o.jsx)(a(),{href:l||"",className:m,...f,onClick:u,children:g});let w=h;return(0,o.jsx)(w,{href:l,className:m,type:d,...f,onClick:u,disabled:p,children:g})}},7992:function(t,e,r){"use strict";r.d(e,{H:function(){return l},a:function(){return i}});var o=r(7437),n=r(2265);let a=(0,n.createContext)({}),l=t=>{let{children:e}=t,[r,l]=(0,n.useState)(),[i,s]=(0,n.useState)(),c=(0,n.useCallback)(async t=>{try{let r=await fetch("".concat("http://localhost:3000","/api/users/create"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.email,password:t.password,passwordConfirm:t.passwordConfirm})});if(r.ok){var e;let{data:t,errors:o}=await r.json();if(o)throw Error(o[0].message);l(null==t?void 0:null===(e=t.loginUser)||void 0===e?void 0:e.user),s("loggedIn")}else throw Error("Invalid login")}catch(t){throw Error("An error occurred while attempting to login.")}},[]),u=(0,n.useCallback)(async t=>{try{let e=await fetch("".concat("http://localhost:3000","/api/users/login"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.email,password:t.password})});if(e.ok){let{user:t,errors:r}=await e.json();if(r)throw Error(r[0].message);return l(t),s("loggedIn"),t}throw Error("Invalid login")}catch(t){throw Error("An error occurred while attempting to login.")}},[]),d=(0,n.useCallback)(async()=>{try{let t=await fetch("".concat("http://localhost:3000","/api/users/logout"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(t.ok)l(null),s("loggedOut");else throw Error("An error occurred while attempting to logout.")}catch(t){throw Error("An error occurred while attempting to logout.")}},[]);(0,n.useEffect)(()=>{let t=async()=>{try{let t=await fetch("".concat("http://localhost:3000","/api/users/me"),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(t.ok){let{user:e}=await t.json();l(e||null),s(e?"loggedIn":void 0)}else throw Error("An error occurred while fetching your account.")}catch(t){throw l(null),Error("An error occurred while fetching your account.")}};t()},[]);let p=(0,n.useCallback)(async t=>{try{let r=await fetch("".concat("http://localhost:3000","/api/users/forgot-password"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.email})});if(r.ok){var e;let{data:t,errors:o}=await r.json();if(o)throw Error(o[0].message);l(null==t?void 0:null===(e=t.loginUser)||void 0===e?void 0:e.user)}else throw Error("Invalid login")}catch(t){throw Error("An error occurred while attempting to login.")}},[]),v=(0,n.useCallback)(async t=>{try{let o=await fetch("".concat("http://localhost:3000","/api/users/reset-password"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t.password,passwordConfirm:t.passwordConfirm,token:t.token})});if(o.ok){var e,r;let{data:t,errors:n}=await o.json();if(n)throw Error(n[0].message);l(null==t?void 0:null===(e=t.loginUser)||void 0===e?void 0:e.user),s((null==t?void 0:null===(r=t.loginUser)||void 0===r?void 0:r.user)?"loggedIn":void 0)}else throw Error("Invalid login")}catch(t){throw Error("An error occurred while attempting to login.")}},[]);return(0,o.jsx)(a.Provider,{value:{user:r,setUser:l,login:u,logout:d,create:c,resetPassword:v,forgotPassword:p,status:i},children:e})},i=()=>(0,n.useContext)(a)},6272:function(t,e,r){"use strict";r.d(e,{Z:function(){return u},j:function(){return s}});var o=r(7437),n=r(2265),a=r(7992);let l=(t,e)=>{var r,o,n;switch(e.type){case"SET_CART":return e.payload;case"MERGE_CART":{let{payload:r}=e,o=[...(null==t?void 0:t.items)||[],...(null==r?void 0:r.items)||[]].reduce((t,e)=>{var r;let o="string"==typeof e.product?e.product:null==e?void 0:null===(r=e.product)||void 0===r?void 0:r.id,n=t.findIndex(t=>{let{product:e}=t;return"string"==typeof e?e===o:(null==e?void 0:e.id)===o});return n>-1?t[n]={...t[n]}:t.push(e),t},[]);return{...t,items:o}}case"ADD_ITEM":{let{payload:n}=e,a="string"==typeof n.product?n.product:null==n?void 0:null===(r=n.product)||void 0===r?void 0:r.id,l=null==t?void 0:null===(o=t.items)||void 0===o?void 0:o.findIndex(t=>{let{product:e}=t;return"string"==typeof e?e===a:(null==e?void 0:e.id)===a}),i=[...(null==t?void 0:t.items)||[]];return -1===l&&i.push(n),"number"==typeof l&&l>-1&&(i[l]={...i[l],quantity:(n.quantity||0)>0?n.quantity:void 0}),{...t,items:i}}case"DELETE_ITEM":{let{payload:r}=e,o={...t},a=null==t?void 0:null===(n=t.items)||void 0===n?void 0:n.findIndex(t=>{let{product:e}=t;return"string"==typeof e?e===r.id:(null==e?void 0:e.id)===r.id});return"number"==typeof a&&o.items&&a>-1&&o.items.splice(a,1),o}case"CLEAR_CART":return{...t,items:[]};default:return t}},i=(0,n.createContext)({}),s=()=>(0,n.useContext)(i),c=t=>Array.isArray(t)&&t.length>0,u=t=>{let{children:e}=t,{user:r,status:s}=(0,a.a)(),[u,d]=(0,n.useReducer)(l,{items:[]}),[p,v]=(0,n.useState)({formatted:"0.00",raw:0}),y=(0,n.useRef)(!1),[h,f]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!y.current){y.current=!0;let t=async()=>{var t;let e=localStorage.getItem("cart"),r=JSON.parse(e||"{}");if((null==r?void 0:r.items)&&(null==r?void 0:null===(t=r.items)||void 0===t?void 0:t.length)>0){let t=await Promise.all(r.items.map(async t=>{let{product:e,quantity:r}=t,o=await fetch("".concat("http://localhost:3000","/api/products/").concat(e)),n=await o.json();return{product:n,quantity:r}}));d({type:"SET_CART",payload:{items:t}})}else d({type:"SET_CART",payload:{items:[]}})};t()}},[]),(0,n.useEffect)(()=>{y.current&&("loggedIn"===s&&d({type:"MERGE_CART",payload:null==r?void 0:r.cart}),"loggedOut"===s&&d({type:"CLEAR_CART"}))},[r,s]),(0,n.useEffect)(()=>{var t;if(!y.current||void 0===r)return;let e={...u,items:null==u?void 0:null===(t=u.items)||void 0===t?void 0:t.map(t=>{var e;return(null==t?void 0:t.product)&&"object"==typeof(null==t?void 0:t.product)?{...t,product:null==t?void 0:null===(e=t.product)||void 0===e?void 0:e.id,quantity:"number"==typeof(null==t?void 0:t.quantity)?null==t?void 0:t.quantity:0}:null}).filter(Boolean)};if(r)try{let t=async()=>{let t=await fetch("".concat("http://localhost:3000","/api/users/").concat(r.id),{credentials:"include",method:"PATCH",body:JSON.stringify({cart:e}),headers:{"Content-Type":"application/json"}});t.ok&&localStorage.setItem("cart","[]")};t()}catch(t){console.error("Error while syncing cart to Payload.")}else localStorage.setItem("cart",JSON.stringify(e));f(!0)},[r,u]);let m=(0,n.useCallback)(t=>{let e=!1,{items:r}=u||{};return Array.isArray(r)&&r.length>0&&(e=!!r.find(e=>{let{product:r}=e;return"string"==typeof r?r===t.id:(null==r?void 0:r.id)===t.id})),e},[u]),g=(0,n.useCallback)(t=>{d({type:"ADD_ITEM",payload:t})},[]),w=(0,n.useCallback)(t=>{d({type:"DELETE_ITEM",payload:t})},[]),_=(0,n.useCallback)(()=>{d({type:"CLEAR_CART"})},[]);return(0,n.useEffect)(()=>{var t;if(!y)return;let e=(null==u?void 0:null===(t=u.items)||void 0===t?void 0:t.reduce((t,e)=>{var r,o,n,a;return t+("object"==typeof e.product?(null===(n=JSON.parse((null==e?void 0:null===(a=e.product)||void 0===a?void 0:a.priceJSON)||"{}"))||void 0===n?void 0:null===(o=n.data)||void 0===o?void 0:null===(r=o[0])||void 0===r?void 0:r.unit_amount)*("number"==typeof(null==e?void 0:e.quantity)?null==e?void 0:e.quantity:0):0)},0))||0;v({formatted:(e/100).toLocaleString("en-US",{style:"currency",currency:"USD"}),raw:e})},[u,y]),(0,o.jsx)(i.Provider,{value:{cart:u,addItemToCart:g,deleteItemFromCart:w,cartIsEmpty:h&&!c(null==u?void 0:u.items),clearCart:_,isProductInCart:m,cartTotal:p,hasInitializedCart:h},children:e&&e})}},7636:function(t){t.exports={label:"Button_label__pYjjJ",button:"Button_button__QvmpL",content:"Button_content__rz2Uk","appearance--primary":"Button_appearance--primary__aXtFJ","appearance--secondary":"Button_appearance--secondary__67RnZ","primary--invert":"Button_primary--invert__abvn4","secondary--invert":"Button_secondary--invert__OpT85","appearance--default":"Button_appearance--default__Hxo2A","appearance--none":"Button_appearance--none__nd_sY"},t.exports.__checksum="feca588f12e7"}}]);